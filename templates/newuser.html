<template>
    <style>

        .input{
            border: none;
            background-color: rgba(0,0, 0, 0);
            border-bottom: solid 2px #aca9a9;
        }


        input:focus{
            border-bottom: solid 2px #eb9c9c;
            color: #eb9c9c;
        }


        .grpSex{
            display: flex;     
            justify-content: center;
        }

        label{
            text-align: right;
        }


    </style>

    <form action="#" id="frmNewUser">
        <input class="input" type="text" id="edtName" placeholder="Name" required>
        <input class="input" type="email" id="edtEmail" placeholder="Email" required>
        <input class="input pass" type="password" id="edtPass" placeholder="Password" required>
        <input class="input pass" type="password" id="edtRePass" placeholder="Repeat Password" required>
    
        <p>Please choose your category:</p>
        <div class="grpSex">
            <div>
                <input type="radio" id="grpMale" name="sex" value="male" checked>
                <label for="male">Male</label>    
            </div>
            <div>
                <input type="radio" id="grpFemale" name="sex" value="female">
                <label for="female">Female</label>    
            </div>
            
        </div>
    
        <button id="btnNewUser">Create User</button>
    </form>

</template>
<script>

    function check(form){

        let elements = form.elements        
        for (let i = 0, element; element = elements[i++];) {
            if(!element.checkValidity()){
                alert('Please, fill all required fields!')
                element.focus()
                return false
            }
        }
    
        let pass = form.querySelectorAll('.pass')
        let val = ''
        if(pass.length > 0){
            for(let i=0; i< pass.length; i++)
            if(i == 0){
                val = pass[i].value
            }else{
                if(val != pass[i].value){
                    alert("Password don't match")
                    pass[i].focus()
                    return false
                }
            }

        }

        return true;
    }


localStorage.clear();
document.getElementById('btnNewUser').addEventListener('click',(event)=>{


    if(check(document.getElementById('frmNewUser')) ){
        event.preventDefault();

        console.log('ok')
    }

/*    

    alert(1)

    const name = document.getElementById('edtName').value.trim();
    const mail = document.getElementById('edtMail').value.trim();
    const pass = document.getElementById('edtPass').value.trim();
    const repass = document.getElementById('edtRePass').value.trim();

console.log(repass)

    const params = new Object;
        params.user = mail;
        params.pass = pass;

    const data = new URLSearchParams();        
    data.append("cod", 0);
    data.append("token", '');
    data.append("params", JSON.stringify(params));

    const myRequest = new Request("db/query_db.php",{
        method : "POST",
        body : data
    });

    const myPromisse = new Promise((resolve,reject) =>{

        fetch(myRequest)
        .then(function (response){

            if (response.status === 200) { 
                resolve(response.text());
            } else { 
                reject(new Error("Houve algum erro na comunicação com o servidor"));
            } 

        });            

    });

    myPromisse.then((resolve)=>{
//            console.log(resolve);
        if(resolve.trim() != ""){
            const json = JSON.parse(resolve);
//                console.log(json);
            localStorage.setItem("id",json[0].id);
            localStorage.setItem("user",json[0].user);
            localStorage.setItem("nome",json[0].nome);
            localStorage.setItem("class",json[0].class);
            localStorage.setItem("token",json[0].token);
            localStorage.setItem("email",json[0].email);
            window.open("main.html","_self")
        }else{
            alert("Usuário ou senha inválido!");
            localStorage.clear();
        }        

    });
*/
});  

</script>